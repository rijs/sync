var sync=function(){"use strict";function n(n){return function(t){return t==n}}function t(n){return function(t){return b(t)(n)}}function e(n){return function(t){return t==n}}function r(n,t,e,u){var i=e.shift();if(!A[t])return!1;if(e.length){if(!(i in n)){if("remove"==t)return!0;n[i]={}}return r(n[i],t,e,u)}return!A[t](n,i,u)}function u(n){return function(t){return D(t)(n)}}var i=function(){var n,t,e=new Promise(function(e,r){n=e,t=r});return arguments.length&&n(arguments[0]),e.resolve=n,e.reject=t,e},o=function n(t,e){return e instanceof Array&&(e=e.reduce(n,[])),(t=t||[]).concat(e)},f=function(n,t,e,r){return n.host&&n.host.nodeName&&(n=n.host),t.name&&(e=t,t=t.name),!function(n,t){return t in n}(n,t)&&Object.defineProperty(n,t,{value:e,writable:r}),n[t]},c=function n(t){function e(n,e){return n.next?n.next(e):e instanceof Array?n.apply(t,e):n.call(t,e)}function r(n,t){for(var e=n.length;~--e;)t!=n[e]&&t!=n[e].fn&&t||n.splice(e,1)}function u(t,e){var o=n((e=e||{}).base||i());return o.i=0,o.li=[],o.fn=e.fn,o.parent=t,o.source=e.fn?o.parent.source:o,o.on("stop",function(){return o.type?o.parent.off(o.type,o):o.parent.off(o)}),o.each=function(n){var t=n.next?n:u(o,{fn:n});return o.li.push(t),t},o.pipe=function(n){return n(o)},o.map=function(n){return o.each(function(t,e,r){return r.next(n(t,e,r))})},o.filter=function(n){return o.each(function(t,e,r){return n(t,e,r)&&r.next(t)})},o.reduce=function(n,t){return o.each(function(e,r,u){return u.next(t=n(t,e,r,u))})},o.unpromise=function(){var n=u(o,{base:{},fn:function(t){return n.next(t)}});return o.li.push(n),n},o.next=function(n){return o.resolve&&o.resolve(n),o.li.length?o.li.map(function(t){return t.fn(n,t.i++,t)}):n},o.until=function(n){return n.each(function(){o.source.emit("stop")}),o},o.off=function(n){return r(o.li,n),o},o[Symbol.asyncIterator]=function(){return{next:function(){return o.wait=new Promise(function(n){o.wait=!0,o.map(function(t,e,r){delete o.wait,o.off(r),n({value:t,done:!1})}),o.emit("pull",o)})}}},o}return t=t||{},f(t,"emit",function(n,r,u){for(var i=t.on[n.split(".")[0]]||[],f=[],c=0;c<i.length;c++)i[c].ns&&u&&!u(i[c].ns)||f.push(e(i[c].isOnce?i.splice(c--,1)[0]:i[c],r));for(c=0;c<t.on["*"].length;c++)f.push(e(t.on["*"][c],[n,r]));return f.reduce(o,[])},1),f(t,"once",function(n,e){return t.on(n,e,!0)},1),f(t,"off",function(n,e){return r(t.on[n]||[],e),e&&e.ns&&delete t.on[n]["$"+e.ns],t},1),f(t,"on",function(n,e,i){function o(n){return n.isOnce=i,n.type=f,c&&(t.on[f]["$"+(n.ns=c)]=n),a.push(n),n.next?n:t}var f=n.split(".")[0],c=n.split(".")[1],a=t.on[f]=t.on[f]||[],s="function"==typeof e?e:0;return!s&&c?(s=t.on[f]["$"+c])?s:o(u(t,e)):s||c?s&&c?o((r(a,t.on[f]["$"+c]||-1),s)):!(!s||c)&&o(s):o(u(t,e))},1),t.on["*"]=t.on["*"]||[],t},a=Math.min,s=Math.pow,l=function(n,t){return function(){var e=window.WebSocket,r=window.setTimeout,u=new e(t);u.onopen=function(){return n.emit("connected",u)},u.onmessage=function(t){return n.emit("recv",t.data)},u.onclose=function(){n.ready=n.once("connected"),n.emit("disconnected"),r(n.connect,p(++n.attempt))}}},p=function(n,t,e){return void 0===t&&(t=100),void 0===e&&(e=1e4),a(e,t*s(2,n))},d=n;n.fn=function(n){return"function"==typeof n},n.str=function(n){return"string"==typeof n},n.num=function(n){return"number"==typeof n},n.obj=function(n){return"object"==typeof n},n.lit=function(n){return n.constructor==Object},n.bol=function(n){return"boolean"==typeof n},n.truthy=function(n){return 1==!!n},n.falsy=function(n){return 0==!!n},n.arr=function(n){return n instanceof Array},n.null=function(n){return null===n},n.def=function(n){return void 0!==n},n.in=function(n){return function(t){return!!n&&(n.indexOf?~n.indexOf(t):t in n)}},n.promise=function(n){return n instanceof Promise},n.stream=function(n){return!(!n||!n.next)};var m=function(n){return Object.keys(d.obj(n)||d.fn(n)?n:{})},v=function(n){return n.__data__},h=function(n){return function(){return n}},y=function(n){return 0===n?"0":n?d.fn(n)?""+n:d.obj(n)?JSON.stringify(n):String(n):""},b=function n(t,e){var r=arguments.length>1,u=d.fn(t)?[]:y(t).split(".").filter(Boolean),i=u.shift();return function(o,f){var c={};return o?d.num(t)||t?d.arr(t)?(t.map(function(t){var e=n(t)(o);void 0!=e&&n(t,d.fn(e)?h(e):e)(c)}),c):o[t]||!u.length?r?(o[t]=d.fn(e)?e(o[t],f):e,o):d.fn(t)?t(o):o[t]:r?(n(u.join("."),e)(o[i]?o[i]:o[i]={}),o):n(u.join("."))(o[i]):r?function(n,t){return m(n).map(function(t){delete n[t]}),m(t).map(function(e){n[e]=t[e]}),n}(o,e):o:void 0}},g=t;t.parent=function(n){return v(this.parentNode)[n]};var x=function(n){void 0===n&&(n={});var t=n.socket;return void 0===t&&(t=function(n){void 0===n&&(n=location.href.replace("http","ws"));var t=c({attempt:0});return t.ready=t.once("connected"),t.connect=l(t,n),t.connect(),t.send=function(n){return t.ready.then(function(t){return t.send(n)})},t}()),t.id=0,t.once("disconnected").map(function(){return t.on("connected").map(j(t))}),t.on("recv").map(function(n){return w(n)}).each(function(n){var e=n.id,r=n.data;return r.exec?r.exec(t.on["$"+e]&&t.on["$"+e][0],r.value):t.emit("$"+e,r)}),Object.defineProperty(_(t),"subscriptions",{get:function(){return O(t)}})},O=function(n){return function(n){return n?m(n).map(g(n)):[]}(n.on).map(function(n){return n&&n[0]}).filter(function(n){return n&&n.type&&"$"==n.type[0]})},j=function(n){return function(){return O(n).map(function(n){return n.type}).map(function(t){return n.send(n.on[t][0].subscription)})}},w=function(n,t){return t={exports:{}},n(t,t.exports),t.exports}(function(n){!function(){function t(n){return"object"==typeof n?null===n?"null":n&&1===n.nodeType?"dom":n instanceof Array?"array":n instanceof Date?"date":"object":typeof n}function e(n){var t=arguments,e=arguments.length;if(e<2||null==n)return n;for(var r=1;r<e;r++)for(var u=t[r],i=Object.keys(u),o=i.length,f=0;f<o;f++){var c=i[f];void 0===n[c]&&(n[c]=u[c])}return n}function r(n,e,u,o){u.prepare&&u.prepare(n),o=o||[];var a=t(n);if(-1!==f.indexOf(a)){var s=o.indexOf(n);if(-1===s){var l={};o[s=e.push({contents:l,value:function(n){var e=t(n);if("function"===e||"date"===e)return i(n);if("object"===e)return d;if("array"===e)return m;return n}(n)})-1]=n;for(var p in n)u.isSerializable(n,p)&&(l[p]=r(n[p],e,u,o))}return c+s}return i(n)}function u(n,e,r,i){if(i=i||[],o(n,c)){var f=parseInt(n.slice(c.length),10);if(!i.hasOwnProperty(f)){var v=e[f],h=function(n){if("string"===t(n)){if(n===l)return;if(o(n,s))return new Function("return "+n.slice(s.length))();if(o(n,p)){var e=parseInt(n.slice(p.length),10);return new Date(e)}if(o(n,d))return{};if(o(n,m))return[];if(n===a)return 1/0}return n}(v.value),y=v.contents;i[f]=h;for(var b in y)h[b]=u(y[b],e,r,i)}return r.finalize&&r.finalize(i[f]),i[f]}return r.finalize&&r.finalize(n),function(n){if("string"===t(n)){if(n===l)return;if(o(n,s)){var e=n.slice(s.length),r=e.indexOf("(")+1,u=e.indexOf(")",r),i=e.slice(r,u),f=e.indexOf("{")+1,c=e.lastIndexOf("}")-1,d=e.slice(f,c);return new Function(i,d)}if(o(n,p)){var m=parseInt(n.slice(p.length),10);return new Date(m)}if(n===a)return 1/0}return n}(n)}function i(n){var e=t(n);if("undefined"===e)return l;if("function"===e)return s+n.toString();if("date"===e)return p+n.getTime();if(n===1/0)return a;if("dom"!==e)return n}function o(n,e){return"string"===t(n)&&n.slice(0,e.length)===e}var f="object array date function".split(" "),c="_CRYO_REF_",a="_CRYO_INFINITY_",s="_CRYO_FUNCTION_",l="_CRYO_UNDEFINED_",p="_CRYO_DATE_",d="_CRYO_OBJECT_",m="_CRYO_ARRAY_",v={stringify:function(n,t){var u=[],i=r(n,u,t=e((t="function"==typeof t?{prepare:t}:t)||{},{prepare:null,isSerializable:function(n,t){return n.hasOwnProperty(t)}}));return JSON.stringify({root:i,references:u})},parse:function(n,t){var r=JSON.parse(n);return t="function"==typeof t?{finalize:t}:t,t=e(t||{},{finalize:null}),u(r.root,r.references,t)}},h=this;n.exports?n.exports=v:h.Cryo=v}()}).parse,_=function(n,t){return function(e,r){if(e instanceof window.Blob)return S(n,e,r);var u=y(++n.id),i=n.on("$"+u),o=function(e,r){return void 0===r&&(r=0),n.send(i.source.subscription=y({id:u,data:e,type:t})).then(function(){return i.emit("sent",{id:u,count:r})})};return e.next?e.map(o).source.emit("start"):o(e),i.source.once("stop").filter(function(n){return"CLOSED"!=n}).map(function(){return _(n,"UNSUBSCRIBE")(u).filter(function(n,t,e){return e.source.emit("stop","CLOSED")})}),i}},S=function(n,t,e,r,u){void 0===r&&(r=0),void 0===u&&(u=1024);var i=c().on("recv"),o=function(e){return function(){return r>=t.size?i.emit("sent",{id:e}):(n.send(t.slice(r,r+=u)),window.setTimeout(o(e)))}};return _(n,"BINARY")({size:t.size,meta:e}).on("sent",function(n){var t=n.id;return o(t)()}).on("progress",function(n){return i.emit("progress",{received:n,total:t.size})}).map(i.next).source.until(i.once("stop")),i},N=e;e.fn=function(n){return"function"==typeof n},e.str=function(n){return"string"==typeof n},e.num=function(n){return"number"==typeof n},e.obj=function(n){return"object"==typeof n},e.lit=function(n){return n.constructor==Object},e.bol=function(n){return"boolean"==typeof n},e.truthy=function(n){return 1==!!n},e.falsy=function(n){return 0==!!n},e.arr=function(n){return n instanceof Array},e.null=function(n){return null===n},e.def=function(n){return void 0!==n},e.in=function(n){return function(t){return!!n&&(n.indexOf?~n.indexOf(t):t in n)}},e.promise=function(n){return n instanceof Promise},e.stream=function(n){return!(!n||!n.next)};var z={arr:function(n){return Array.prototype.slice.call(n,0)},obj:function(n){function t(n,t,r){return 0===r&&(n={}),n[N.fn(e)?e(t,r):t[e]]=t,n}var e="id";return 1==arguments.length?(e=n,t):t.apply(this,arguments)}},P=function(){var n,t,e=new Promise(function(e,r){n=e,t=r});return arguments.length&&n(arguments[0]),e.resolve=n,e.reject=t,e},C=function n(t,e){return e instanceof Array&&(e=e.reduce(n,[])),(t=t||[]).concat(e)},I=function(n,t,e,r){return n.host&&n.host.nodeName&&(n=n.host),t.name&&(e=t,t=t.name),!function(n,t){return t in n}(n,t)&&Object.defineProperty(n,t,{value:e,writable:r}),n[t]},R=function n(t){function e(n,e){return n.next?n.next(e):e instanceof Array?n.apply(t,e):n.call(t,e)}function r(n,t){for(var e=n.length;~--e;)t!=n[e]&&t!=n[e].fn&&t||n.splice(e,1)}function u(t,e){var i=n((e=e||{}).base||P());return i.i=0,i.li=[],i.fn=e.fn,i.parent=t,i.source=e.fn?i.parent.source:i,i.on("stop",function(){return i.type?i.parent.off(i.type,i):i.parent.off(i)}),i.each=function(n){var t=n.next?n:u(i,{fn:n});return i.li.push(t),t},i.pipe=function(n){return n(i)},i.map=function(n){return i.each(function(t,e,r){return r.next(n(t,e,r))})},i.filter=function(n){return i.each(function(t,e,r){return n(t,e,r)&&r.next(t)})},i.reduce=function(n,t){return i.each(function(e,r,u){return u.next(t=n(t,e,r,u))})},i.unpromise=function(){var n=u(i,{base:{},fn:function(t){return n.next(t)}});return i.li.push(n),n},i.next=function(n){return i.resolve&&i.resolve(n),i.li.length?i.li.map(function(t){return t.fn(n,t.i++,t)}):n},i.until=function(n){return n.each(function(){i.source.emit("stop")}),i},i.off=function(n){return r(i.li,n),i},i[Symbol.asyncIterator]=function(){return{next:function(){return i.wait=new Promise(function(n){i.wait=!0,i.map(function(t,e,r){delete i.wait,i.off(r),n({value:t,done:!1})}),i.emit("pull",i)})}}},i}return t=t||{},I(t,"emit",function(n,r,u){for(var i=t.on[n.split(".")[0]]||[],o=[],f=0;f<i.length;f++)i[f].ns&&u&&!u(i[f].ns)||o.push(e(i[f].isOnce?i.splice(f--,1)[0]:i[f],r));for(f=0;f<t.on["*"].length;f++)o.push(e(t.on["*"][f],[n,r]));return o.reduce(C,[])},1),I(t,"once",function(n,e){return t.on(n,e,!0)},1),I(t,"off",function(n,e){return r(t.on[n]||[],e),e&&e.ns&&delete t.on[n]["$"+e.ns],t},1),I(t,"on",function(n,e,i){function o(n){return n.isOnce=i,n.type=f,c&&(t.on[f]["$"+(n.ns=c)]=n),a.push(n),n.next?n:t}var f=n.split(".")[0],c=n.split(".")[1],a=t.on[f]=t.on[f]||[],s="function"==typeof e?e:0;return!s&&c?(s=t.on[f]["$"+c])?s:o(u(t,e)):s||c?s&&c?o((r(a,t.on[f]["$"+c]||-1),s)):!(!s||c)&&o(s):o(u(t,e))},1),t.on["*"]=t.on["*"]||[],t},A={add:function(n,t,e){N.arr(n)?n.splice(t,0,e):n[t]=e},update:function(n,t,e){if(N.num(t)||t)n[t]=e;else{if(!N.obj(e))return!0;for(var r in n)delete n[r];for(var r in e)n[r]=e[r]}},remove:function(n,t){N.arr(n)?n.splice(t,1):delete n[t]}},$=JSON.stringify,B=JSON.parse,k=function(n){return function(){return!n.apply(this,arguments)}},E=function(n){return function(){return n}},Y=function(n){return Object.keys(N.obj(n)||N.fn(n)?n:{})},D=function n(t,e){var r=arguments.length>1,u=N.fn(t)?[]:function(n){return 0===n?"0":n?N.fn(n)?""+n:N.obj(n)?JSON.stringify(n):String(n):""}(t).split(".").filter(Boolean),i=u.shift();return function(o,f){var c={};return o?N.num(t)||t?N.arr(t)?(t.map(function(t){var e=n(t)(o);void 0!=e&&n(t,N.fn(e)?E(e):e)(c)}),c):o[t]||!u.length?r?(o[t]=N.fn(e)?e(o[t],f):e,o):N.fn(t)?t(o):o[t]:r?(n(u.join("."),e)(o[i]?o[i]:o[i]={}),o):n(u.join("."))(o[i]):r?function(n,t){return Y(n).map(function(t){delete n[t]}),Y(t).map(function(e){n[e]=t[e]}),n}(o,e):o:void 0}},T=function(n){return n.__data__},F=u;u.parent=function(n){return T(this.parentNode)[n]};var J=function(n){return function(t,e,r){return t instanceof Blob?n(t,e):n(N.obj(t)?t:{name:t,type:e,value:r})}},U=function(n){return function(t,e){if(n.subscriptions[t]=n.subscriptions[t]||{},N.arr(e))return Promise.all(e.map(function(e){return n.get(t,e)}));var r=D(e)(D("resources."+t+".body")(n));return e in n.subscriptions[t]&&r?Promise.resolve(r):n.subscribe(t,e).filter(function(n,t,e){return e.source.emit("stop")}).map(function(){return D(e)(D("resources."+t+".body")(n))})}},L=function(n,t,e){return function(u){return N.def(e)&&(u.key=e+"."+str(u.key)),u.key||"update"!=u.type?function(n,t){return function(e,u,i){if(!N.obj(e)&&!N.fn(e))return e;if(!N.obj(n)){var o=u||e.log||[],f=e;if(N.def(i)||(i=o.max||0),i||(o=[]),i<0&&(o=o.concat(null)),i>0){var c=$(e);f=B(c),o=o.concat({type:"update",value:B(c),time:o.length})}return I(o,"max",i),f.log?f.log=o:I(R(f),"log",o,1),f}return!!N.def(n.key)&&!!r(e,n.type,(n.key=""+n.key).split(".").filter(Boolean),n.value)&&(e.log&&e.log.max&&e.log.push((n.time=e.log.length,e.log.max>0?n:null)),!t&&e.emit&&e.emit("change",n),e)}}(u)(t in n.resources?n(t):n(t,{})):n(G(function(n){return function(t){return Y(t).filter(k(N.in(n))).map(function(n,t){return function(e){return t[e]=n[e],e}}(t,n)),n}}({name:t})(u))),u}},M=function(n){var t=R().on("next"),e=[];return n.map(function(n,r){return n.each(function(n){e[r]=n,t.next(e)})}),t.once("stop").map(function(){return n.map(function(n){return n.source.emit("stop")})}),t},W=function(n){return function(t,e){if(N.arr(t))return M(t.map(function(t){return n.subscribe(t,e)}));if(n.subscriptions[t]=n.subscriptions[t]||{},N.arr(e))return M(e.map(function(e){return n.subscribe(t,e)})).map(function(){return D(e)(n(t))});var r=R().on("next");r.on("stop").filter(function(){return u.off(r.next)&&!u.li.length}).map(function(){return u.source.emit("stop")}).map(function(){n.subscriptions[t][e]=void 0}),n.subscriptions[t][e]&&r.on("start").map(function(){return D(e)(n(t))}).filter(N.def).map(function(n){return r.next(n)});var u=n.subscriptions[t][e]=n.subscriptions[t][e]||n.send(t,"SUBSCRIBE",e).map(L(n,t,e)).map(function(){return D(e)(n(t))});return u.each(r.next),r}},q=function(n){return function(t,e){var r=++n.upload.id,u={},i=0,o=function(){if(!f.length)return!0;var t=f.shift(),e=t.field,u=t.filename,a=t.i,s=t.blob;return n.send(s,{filename:u,field:e,i:a,index:r}).on("progress",function(n){var t=n.received;return c.emit("progress",{total:i,received:i-(s.size-t)-f.reduce(function(n,t){return n+=t.blob.size},0)})}).then(o)},f=Y(e).map(function(n){return u[n]=e[n],n}).filter(function(n){return e[n]instanceof FileList}).map(function(n){return u[n]=[],z.arr(e[n]).map(function(n){return i+=n.size,n}).map(function(t,e){return{field:n,filename:t.name,i:e,blob:t,sent:0}})}).reduce(C,[]),c=n.send({files:f.length,type:"PREUPLOAD",fields:u,index:r,size:i,name:t}).once("sent",o);return c}},G=function(n){var t=n.name,e=n.value;return{name:t,headers:n.headers,body:e}},H=function(n){return function(t){return function(e){return!n.deps(e).filter(k(N.in(n.subscriptions))).map(function(t){return n.subscribe(t)}).length&&t(e)}}},K=function(n){return function(t){return function(n){return n?Y(n).map(F(n)):[]}(n.types).filter(function(n){return n.extract}).map(function(n){return n.extract(t)}).reduce(function(n,t){return n.concat(t)},[]).filter(Boolean)}};return function(n,t,e){void 0===t&&(t={}),void 0===e&&(e={});var r=e.xrs;return void 0===r&&(r=x),n.send=J(r()),n.subscribe=W(n),n.subscriptions={},n.get=U(n),n.upload=q(n),n.upload.id=0,n.render=H(n)(n.render),n.deps=K(n),n}}();
