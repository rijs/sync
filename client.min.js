var sync=function(){"use strict";var n=function(){var n,t,e=new Promise(function(e,r){n=e,t=r});return arguments.length&&n(arguments[0]),e.resolve=n,e.reject=t,e};var t=function n(t,e){return e instanceof Array&&(e=e.reduce(n,[])),(t=t||[]).concat(e)},e=function(n,t,e,r){return n.host&&n.host.nodeName&&(n=n.host),t.name&&(e=t,t=t.name),!function(n,t){return t in n}(n,t)&&Object.defineProperty(n,t,{value:e,writable:r}),n[t]},r=function(){},u=function u(o,i){return i=i||{},e(o=o||{},"emit",function(n,e,r){for(var u=o.on[n.split(".")[0]]||[],i=[],f=0;f<u.length;f++)u[f].ns&&r&&!r(u[f].ns)||i.push(c(u[f].isOnce?u.splice(f--,1)[0]:u[f],e));for(var f=0;f<o.on["*"].length;f++)i.push(c(o.on["*"][f],[n,e]));return i.reduce(t,[])},1),e(o,"once",function(n,t){return o.on(n,t,!0)},1),e(o,"off",function(n,t){f(o.on[n]||[],t),t&&t.ns&&delete o.on[n]["$"+t.ns];return o},1),e(o,"on",function(n,t,e){var u=n.split(".")[0],c=n.split(".")[1],a=o.on[u]=o.on[u]||[],l="function"==typeof t?t:0;return!l&&c?(l=o.on[u]["$"+c])?l:p(s(o,t)):l||c?l&&c?p((f(a,o.on[u]["$"+c]||-1),l)):!(!l||c)&&p(l):p(s(o,t));function p(n){return n.isOnce=e,n.type=u,c&&(o.on[u]["$"+(n.ns=c)]=n),a.push(n),(i.on||r)(n),n.next?n:o}},1),o.on["*"]=o.on["*"]||[],o;function c(n,t){return n.next?n.next(t):t instanceof Array?n.apply(o,t):n.call(o,t)}function f(n,t){for(var e=n.length;~--e;)t!=n[e]&&t!=n[e].fn&&t||(i.off||r)(n.splice(e,1)[0])}function s(t,e){var r=u((e=e||{}).base||n());return r.i=0,r.li=[],r.fn=e.fn,r.parent=t,r.source=e.fn?r.parent.source:r,r.on("stop",function(n){return r.type?r.parent.off(r.type,r):r.parent.off(r),r.reason=n}),r.each=function(n){var t=n.next?n:s(r,{fn:n});return r.li.push(t),t},r.pipe=function(n){return n(r)},r.map=function(n){return r.each(function(t,e,r){return r.next(n(t,e,r))})},r.filter=function(n){return r.each(function(t,e,r){return n(t,e,r)&&r.next(t)})},r.reduce=function(n,t){return r.each(function(e,r,u){return u.next(t=n(t,e,r,u))})},r.unpromise=function(){var n=s(r,{base:{},fn:function(t){return n.next(t)}});return r.li.push(n),n},r.next=function(n){return r.resolve&&r.resolve(n),r.li.length?r.li.map(function(t){return t.fn(n,t.i++,t)}):n},r.until=function(n){return(n.each||n.then).call(n,function(n){return r.source.emit("stop",n)}),r},r.off=function(n){return f(r.li,n),r},r.start=function(){return r.source.emit("start"),r},r[Symbol.asyncIterator]=function(){return{next:function(){return r.wait=new Promise(function(n){r.wait=!0,r.map(function(t,e,u){delete r.wait,r.off(u),n({value:t,done:!1})}),r.emit("pull",r)})}}},r}},o=Math.min,i=Math.pow,c=function(n,t){return function(){var e=window.WebSocket,r=window.setTimeout,u=new e(t);u.onopen=function(){return n.emit("connected",u)},u.onmessage=function(t){return n.emit("recv",t.data)},u.onclose=function(){n.ready=n.once("connected"),n.emit("disconnected"),r(n.connect,f(++n.attempt))}}},f=function(n,t,e){return void 0===t&&(t=100),void 0===e&&(e=1e4),o(e,t*i(2,n))},s=a;function a(n){return function(t){return t==n}}a.fn=function(n){return"function"==typeof n},a.str=function(n){return"string"==typeof n},a.num=function(n){return"number"==typeof n},a.obj=function(n){return"object"==typeof n},a.lit=function(n){return n.constructor==Object},a.bol=function(n){return"boolean"==typeof n},a.truthy=function(n){return 1==!!n},a.falsy=function(n){return 0==!!n},a.arr=function(n){return n instanceof Array},a.null=function(n){return null===n},a.def=function(n){return void 0!==n},a.in=function(n){return function(t){return!!n&&(n.indexOf?~n.indexOf(t):t in n)}},a.promise=function(n){return n instanceof Promise},a.stream=function(n){return!(!n||!n.next)};var l=function(n){return Object.keys(s.obj(n)||s.fn(n)?n:{})},p=function(n){return n.__data__},m=function(n){return function(){return n}},d=function(n){return 0===n?"0":n?s.fn(n)?""+n:s.obj(n)?JSON.stringify(n):String(n):""},v=function n(t,e){var r=arguments.length>1,u=s.fn(t)?[]:d(t).split(".").filter(Boolean),o=u.shift();return function(i,c){var f={};return i?s.num(t)||t?s.arr(t)?(t.map(function(t){var r=n(t)(i);null!=(r=s.fn(e)?e(r):null==r?e:r)&&n(t,s.fn(r)?m(r):r)(f)}),f):i[t]||!u.length?r?(i[t]=s.fn(e)?e(i[t],c):e,i):s.fn(t)?t(i):i[t]:r?(n(u.join("."),e)(i[o]?i[o]:i[o]={}),i):n(u.join("."))(i[o]):r?function(n,t){return l(n).map(function(t){delete n[t]}),l(t).map(function(e){n[e]=t[e]}),n}(i,e):i:void 0}},h=b;function b(n){return function(t){return v(t)(n)}}b.parent=function(n){return p(this.parentNode)[n]};var y=function(n){void 0===n&&(n={});var t=n.socket;void 0===t&&(t=function(n){void 0===n&&(n=location.href.replace("http","ws"));var t=u({attempt:0});return t.ready=t.once("connected"),t.connect=c(t,n),t.connect(),t.send=function(n){return t.ready.then(function(t){return t.send(n)})},t}()),t.id=0;var e=u({socket:t,send:j(t),get subscriptions(){return(n=t.on,n?l(n).map(h(n)):[]).map(function(n){return n&&n[0]}).filter(function(n){return n&&n.type&&"$"==n.type[0]});var n}});return t.once("disconnected").map(function(){return t.on("connected").map(x(e))}),t.on("recv").map(g).each(function(n){var r=n.id,u=n.data,o=t.on["$"+r]&&t.on["$"+r][0];u.exec?u.exec(o,u.value):r?t.emit("$"+r,u):e.emit("recv",u)}),e},g=function(n){return new Function("return "+n)()},x=function(n){return function(){return n.subscriptions.map(function(t){var e=t.subscription;return n.socket.send(e)})}},j=function(n,t){return function(e,r){if(e instanceof window.Blob)return w(n,e,r);var u=d(++n.id),o=n.on("$"+u),i=function(e,r){return void 0===r&&(r=0),n.send(o.source.subscription=d({id:u,data:e,type:t})).then(function(){return o.emit("sent",{id:u,count:r})})};return e.next?e.map(i).source.emit("start"):i(e),o.source.once("stop").filter(function(n){return"CLOSED"!=n}).map(function(){return j(n,"UNSUBSCRIBE")(u).filter(function(n,t,e){return e.source.emit("stop","CLOSED")})}),o}},w=function(n,t,e,r,o){void 0===r&&(r=0),void 0===o&&(o=1024);var i=u().on("recv"),c=function(e){return function(){return r>=t.size?i.emit("sent",{id:e}):(n.send(t.slice(r,r+=o)),window.setTimeout(c(e)))}};return j(n,"BINARY")({size:t.size,meta:e}).on("sent",function(n){var t=n.id;return c(t)()}).on("progress",function(n){return i.emit("progress",{received:n,total:t.size})}).map(i.next).source.until(i.once("stop")),i},O=S;function S(n){return function(t){return t==n}}S.fn=function(n){return"function"==typeof n},S.str=function(n){return"string"==typeof n},S.num=function(n){return"number"==typeof n},S.obj=function(n){return"object"==typeof n},S.lit=function(n){return n.constructor==Object},S.bol=function(n){return"boolean"==typeof n},S.truthy=function(n){return 1==!!n},S.falsy=function(n){return 0==!!n},S.arr=function(n){return n instanceof Array},S.null=function(n){return null===n},S.def=function(n){return void 0!==n},S.in=function(n){return function(t){return!!n&&(n.indexOf?~n.indexOf(t):t in n)}},S.promise=function(n){return n instanceof Promise},S.stream=function(n){return!(!n||!n.next)};var $={arr:function(n){return Array.prototype.slice.call(n,0)},obj:function(n){var t="id";return 1==arguments.length?(t=n,e):e.apply(this,arguments);function e(n,e,r){return 0===r&&(n={}),n[O.fn(t)?t(e,r):e[t]]=e,n}}};var k=function(){var n,t,e=new Promise(function(e,r){n=e,t=r});return arguments.length&&n(arguments[0]),e.resolve=n,e.reject=t,e};var B=function n(t,e){return e instanceof Array&&(e=e.reduce(n,[])),(t=t||[]).concat(e)},P=function(n,t,e,r){return n.host&&n.host.nodeName&&(n=n.host),t.name&&(e=t,t=t.name),!function(n,t){return t in n}(n,t)&&Object.defineProperty(n,t,{value:e,writable:r}),n[t]},A=function(){},N=function n(t,e){return e=e||{},P(t=t||{},"emit",function(n,e,u){for(var o=t.on[n.split(".")[0]]||[],i=[],c=0;c<o.length;c++)o[c].ns&&u&&!u(o[c].ns)||i.push(r(o[c].isOnce?o.splice(c--,1)[0]:o[c],e));for(var c=0;c<t.on["*"].length;c++)i.push(r(t.on["*"][c],[n,e]));return i.reduce(B,[])},1),P(t,"once",function(n,e){return t.on(n,e,!0)},1),P(t,"off",function(n,e){u(t.on[n]||[],e),e&&e.ns&&delete t.on[n]["$"+e.ns];return t},1),P(t,"on",function(n,r,i){var c=n.split(".")[0],f=n.split(".")[1],s=t.on[c]=t.on[c]||[],a="function"==typeof r?r:0;return!a&&f?(a=t.on[c]["$"+f])?a:l(o(t,r)):a||f?a&&f?l((u(s,t.on[c]["$"+f]||-1),a)):!(!a||f)&&l(a):l(o(t,r));function l(n){return n.isOnce=i,n.type=c,f&&(t.on[c]["$"+(n.ns=f)]=n),s.push(n),(e.on||A)(n),n.next?n:t}},1),t.on["*"]=t.on["*"]||[],t;function r(n,e){return n.next?n.next(e):e instanceof Array?n.apply(t,e):n.call(t,e)}function u(n,t){for(var r=n.length;~--r;)t!=n[r]&&t!=n[r].fn&&t||(e.off||A)(n.splice(r,1)[0])}function o(t,e){var r=n((e=e||{}).base||k());return r.i=0,r.li=[],r.fn=e.fn,r.parent=t,r.source=e.fn?r.parent.source:r,r.on("stop",function(n){return r.type?r.parent.off(r.type,r):r.parent.off(r),r.reason=n}),r.each=function(n){var t=n.next?n:o(r,{fn:n});return r.li.push(t),t},r.pipe=function(n){return n(r)},r.map=function(n){return r.each(function(t,e,r){return r.next(n(t,e,r))})},r.filter=function(n){return r.each(function(t,e,r){return n(t,e,r)&&r.next(t)})},r.reduce=function(n,t){return r.each(function(e,r,u){return u.next(t=n(t,e,r,u))})},r.unpromise=function(){var n=o(r,{base:{},fn:function(t){return n.next(t)}});return r.li.push(n),n},r.next=function(n){return r.resolve&&r.resolve(n),r.li.length?r.li.map(function(t){return t.fn(n,t.i++,t)}):n},r.until=function(n){return n.each?n.each(r.stop):n.then?n.then(r.stop):n.call?r.filter(n).map(r.stop):0},r.off=function(n){return u(r.li,n),r},r.start=function(){return r.source.emit("start"),r},r.stop=function(n){return r.source.emit("stop",n)},r[Symbol.asyncIterator]=function(){return{next:function(){return r.wait=new Promise(function(n){r.wait=!0,r.map(function(t,e,u){delete r.wait,r.off(u),n({value:t,done:!1})}),r.emit("pull",r)})}}},r}},z={add:function(n,t,e){O.arr(n)?n.splice(t,0,e):n[t]=e},update:function(n,t,e){if(O.num(t)||t)n[t]=e;else{if(!O.obj(e))return!0;for(var r in n)delete n[r];for(var r in e)n[r]=e[r]}},remove:function(n,t){O.arr(n)?n.splice(t,1):delete n[t]}},E=JSON.stringify,I=JSON.parse,C=function(n,t){return function(e,r,u){if(!O.obj(e)&&!O.fn(e))return e;if(!O.obj(n)){var o=r||e.log||[],i=e;if(O.def(u)||(u=o.max||0),u||(o=[]),u<0&&(o=o.concat(null)),u>0){var c=E(e);i=I(c),o=o.concat({type:"update",value:I(c),time:o.length})}return P(o,"max",u),i.log?i.log=o:P(N(i,null),"log",o,1),i}return!!O.def(n.key)&&(!!function n(t,e,r,u){var o=r.shift();if(!z[e])return!1;if(r.length){if(!(o in t)){if("remove"==e)return!0;t[o]={}}return n(t[o],e,r,u)}return!z[e](t,o,u)}(e,n.type,(n.key=""+n.key).split(".").filter(Boolean),n.value)&&(e.log&&e.log.max&&e.log.push((n.time=e.log.length,e.log.max>0?n:null)),!t&&e.emit&&e.emit("change",n),e))}};var J=function(n){return function(){return n}},L=function(n){return Object.keys(O.obj(n)||O.fn(n)?n:{})},R=function(n){return 0===n?"0":n?O.fn(n)?""+n:O.obj(n)?JSON.stringify(n):String(n):""},T=function n(t,e){var r=arguments.length>1,u=O.fn(t)?[]:R(t).split(".").filter(Boolean),o=u.shift();return function(i,c){var f={};return i?O.num(t)||t?O.arr(t)?(t.map(function(t){var r=n(t)(i);null!=(r=O.fn(e)?e(r):null==r?e:r)&&n(t,O.fn(r)?J(r):r)(f)}),f):i[t]||!u.length?r?(i[t]=O.fn(e)?e(i[t],c):e,i):O.fn(t)?t(i):i[t]:r?(n(u.join("."),e)(i[o]?i[o]:i[o]={}),i):n(u.join("."))(i[o]):r?function(n,t){return L(n).map(function(t){delete n[t]}),L(t).map(function(e){n[e]=t[e]}),n}(i,e):i:void 0}},U=function(n){var t=n.server;return function(n,e,r){return n instanceof Blob?t.send(n,e):O.obj(n)?t.send(n):t.send({name:n,type:e,value:r})}},_=function(n){return function(t,e){return n.subscribe(t,e).filter(function(n,t,e){return e.source.emit("stop")}).start()}},D=function(n,t,e){return function(r){var u=r.name=r.name||t;return r.type||(r.type="update"),O.def(e)&&(r.key=e+"."+R(r.key)),r.key||"update"!=r.type?C(r)(n.resources[u]?n(u):n(u,{})):n(W(r)),n.change=r,T(e)(n(u))}},F=function(n){return function(t,e){if(O.arr(t))return Y(t.map(function(t){return n.subscribe(t,e)})).map(function(n){return t.reduce(function(t,e,r){return t[e]=n[r],t},{})});if(n.subscriptions[t]=n.subscriptions[t]||{},O.arr(e))return Y(e.map(function(e){return n.subscribe(t,e)})).map(function(){return T(e)(n(t))});var r=N().on("subscription");r.on("stop").each(function(){u.subs.splice(u.subs.indexOf(r),1),function(n,t){1===arguments.length?setTimeout(n):setTimeout(t,n)}(1e3,function(){u.subs.length||(u.source.emit("stop"),n.subscriptions[t][e]=void 0,r.emit("end"))})}),n.subscriptions[t][e]&&r.on("start").map(function(){return T(e)(n(t))}).filter(O.def).map(function(n){return r.next(n)});var u=n.subscriptions[t][e]=n.subscriptions[t][e]||n.send(t,"SUBSCRIBE",e).map(D(n,t,e)).each(function(t){u.subs.map(function(n){return n.next(t)}),delete n.change});return u.subs=u.subs||[],u.subs.push(r),r}},M=function(n){return function(t,e){var r=++n.upload.id,u={},o=0,i=function(){if(!c.length)return!0;var t=c.shift(),e=t.field,u=t.filename,s=t.i,a=t.blob;return n.send(a,{filename:u,field:e,i:s,index:r}).on("progress",function(n){var t=n.received;return f.emit("progress",{total:o,received:o-(a.size-t)-c.reduce(function(n,t){return n+t.blob.size},0)})}).then(i)},c=L(e).map(function(n){return u[n]=e[n],n}).filter(function(n){return e[n]instanceof FileList}).map(function(n){return u[n]=[],$.arr(e[n]).map(function(n){return o+=n.size,n}).map(function(t,e){return{field:n,filename:t.name,i:e,blob:t,sent:0}})}).reduce(B,[]),f=n.send({files:c.length,type:"PREUPLOAD",fields:u,index:r,size:o,name:t}).once("sent",i);return f}},W=function(n){var t=n.name,e=n.value;return{name:t,headers:n.headers,body:e}},Y=function(n){var t=N().on("merged");return t.streams=n,n.map(function(e){return e.each(function(r){e.latest=r;var u=n.map(function(n){return n.latest});u.every(O.def)&&t.next(u)})}),t.once("start").map(function(){return n.map(function(n){return n.source.emit("start")})}),t.once("stop").map(function(){return n.map(function(n){return n.source.emit("stop")})}),t};return function(n,t,e){void 0===t&&(t={}),void 0===e&&(e={});var r=e.xrs;return void 0===r&&(r=y),n.server=r(),n.send=U(n),n.subscribe=F(n),n.subscriptions={},n.get=_(n),n.upload=M(n),n.upload.id=0,n.server.on("recv").map(function(t,e,r){return D(n)(t,e,r)}),n}}();
